
extends layout
	
block content
	nav.navbar.navbar-expand.navbar-light.bg-light
		.nav-item
			.navbar-brand Price Alerts
		.navbar-nav.ml-auto
			.nav-item
				button.btn.navbar-btn.btn-outline-dark#btn-logout Sign Out

	div(style='margin:20px auto;text-align:center')
		button.btn.btn-outline-dark#btn-create-price-alert Create Alert
		button.btn.btn-outline-dark#btn-link-telegram Link Telegram
	input(type='hidden', value= udata._id)#udataId
	input(type='hidden', value= udata.telegramChatId)#udataTelegramChatId

	div.container
		table.table.table-bordered.table-striped
			thead.thead-dark
				tr
					th(style='width:50px;text-align:center') #
					th(style='width:50px') Exchange
					th(style='width:50px') Trading Pair
					th(style='width:50px') Price
					th(style='width:50px') Cross Type
					th(style='width:220px') Message
					th(style='width:50px;text-align:center') Delete
			tbody
			- for (var i = 0; i < alerts.length; i++)
				tr
					td(style='text-align:center')= i+1
					td= alerts[i].exchange
					td= alerts[i].pair
					td= alerts[i].price
					td= alerts[i].cross
					td= alerts[i].message
					td(style='text-align:center')
						button(type='button', data-id=alerts[i]._id).btn.btn-outline-dark.btn-delete-price X

	div.overlay.hide

	div.center-vertical.modal-link-telegram.hide
		div.card.card-body.bg-light
			h6.
				To be able to receive alerts, download and open the Telegram app and send the following passcode to 
				#{botName}
				from your phone:
			hr
			h5(style='text-align:center')= udata.telegramPasscode
			hr
			button(type='button', style='width:60px;margin:auto').cancel.btn.btn-outline-dark#btn-cancel-link-telegram Ok

	div.center-vertical.modal-create-price-alert.hide
		form.card.card-body.bg-light(method='post')#price-alerts-form
			h2
			h6#sub Create a new price alert.
			hr
			.form-group.row.margin-zero
				label.col-sm-3.col-form-label.col-form-label-sm Trading Pair
				.col-sm-9
					select.custom-select#pair-list(name='exchangePair')
						each item in pairs
							optgroup(label= item.exchange)
								each pair in item.pairs
									option(value= item.exchange+'-'+pair)= pair

			.form-group.row
				label.col-sm-3.col-form-label.col-form-label-sm Price Alert
				.col-sm-9
					input.form-control#price-tf(type='text', name='price', value='')

			.form-group.row.margin-zero
				label.col-sm-3.col-form-label.col-form-label-sm Cross Type
				.col-sm-9
					select.custom-select#cross-list(name='cross')
						option Cross Up
						option Cross Down
			.form-group.row
				label.col-sm-3.col-form-label.col-form-label-sm Message
				.col-sm-9
					textarea.form-control(type='text', name='message', value='', maxlength="200")
			hr
			.form-buttons
				button(type='button')#price-alerts-form-button.btn.btn-primary Submit
				button(type='button').cancel.btn.btn-outline-dark#btn-cancel-create-price-alert Cancel

	// display form errors in a custom modal window //

	include modals/form-errors
	include modals/alert



block scripts
	script(src='/js/views/price-alerts.js')
	script(src='/js/controllers/homeController.js')
	script(src='/js/form-validators/accountValidator.js')
	script(src='https://cdn.jsdelivr.net/npm/select2@4.0.12/dist/js/select2.min.js')